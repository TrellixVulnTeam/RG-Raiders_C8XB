var r=require("wonka"),e=require("@urql/core");function t(){return(t=Object.assign||function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r}).apply(this,arguments)}exports.retryExchange=function(n){var a=n.initialDelayMs||1e3,o=n.maxDelayMs||15e3,u=n.maxNumberAttempts||2,i=n.randomDelay||!0,c=n.retryIf||function(r){return r&&r.networkError};return function(n){var y=n.forward;return function(n){var f=r.share(n),l=r.makeSubject(),p=l.source,m=l.next,s=r.mergeMap((function(n){var u=n.key,c=n.context,y=(c.retryCount||0)+1,l=c.retryDelay||a,p=Math.random()+1.5;i&&l*p<o&&(l*=p);var m=r.filter((function(r){return("query"===r.kind||"teardown"===r.kind)&&r.key===u}))(f);return r.takeUntil(m)(r.delay(l)(r.fromValue(e.makeOperation(n.kind,n,t({},n.context,{retryDelay:l,retryCount:y})))))}))(p);return r.filter((function(r){return!(r.error&&c(r.error,r.operation)&&!((r.operation.context.retryCount||0)>=u-1)&&(m(r.operation),1))}))(r.share(y(r.merge([f,s]))))}}};
//# sourceMappingURL=urql-exchange-retry.min.js.map
